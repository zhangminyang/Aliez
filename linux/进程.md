# 进程

## 进程、线程、协程

### 进程
进程是程序执行时的一个实例，是作为分配系统资源的实体。进程在执行过程中拥有独立的内存单元

进程是对*指令集*和*虚拟存储器*的抽象
指令集是指程序代码 虚拟存储器包括用户栈，堆

### 实现
每个进程有一个*进程描述符*表示，这个描述符包含有关进程当前状态的信息

当一个内核暂停一个进程的执行时，就把几个相关的处理器寄存器的内容保存在进程描述符中。
这些寄存器包括：
* 程序计数器（PC）和栈指针（SP）寄存器
* 通用寄存器
* 浮点寄存器
* 包含CPU状态信息的处理器控制寄存器
* 用来跟踪进程对RAM访问的内存管理寄存器

党内和决定恢复一个进程时，他用进程描述符中合适的字段来装载CPU寄存器。因为程序计数器中索村的之只想吓一跳将要执行的指令，所以进程从它停止的地方恢复执行。
## 线程
线城是进程的实体，是CPU进行调度和分派的基本单位。线程自己基本上不拥有系统资源,只拥有一点在运行中必不可少的资源(如程序计数器,一组寄存器和栈),但是它可与同属一个进程的其他的线程共享进程所拥有的全部资源。线程间通信主要通过共享内存，上下文切换很快，资源开销较少，但相比进程不够稳定容易丢失数据。

堆：　是大家共有的空间，分全局堆和局部堆。全局堆就是所有没有分配的空间，局部堆就是用户分配的空间。堆在操作系统对进程初始化的时候分配，运行过程中也可以向系统要额外的堆，但是记得用完了要还给操作系统，要不然就是内存泄漏。

栈：是个线程独有的，保存其运行状态和局部自动变量的。栈在线程开始的时候初始化，每个线程的栈互相独立，因此，栈是　thread safe的。操作系统在切换线程的时候会自动的切换栈，就是切换　ＳＳ／ＥＳＰ寄存器。栈空间不需要在高级语言里面显式的分配和释放。